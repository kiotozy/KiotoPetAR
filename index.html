<!DOCTYPE html>
<html lang="pt-br">
<head>
Â  <meta charset="utf-8">
Â  <title>Kioto Pet AR</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
Â  <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
Â  <script src="https://cdn.jsdelivr.net/npm/aframe-gesture-detector@3.3.0/dist/aframe-gesture-detector.min.js"></script>
Â  <style>
Â  Â  body {
Â  Â  Â  margin: 0;
Â  Â  Â  overflow: hidden;
Â  Â  Â  font-family: sans-serif;
Â  Â  }
Â  Â  #buttons {
Â  Â  Â  position: fixed;
Â  Â  Â  bottom: 20px;
Â  Â  Â  left: 0;
Â  Â  Â  width: 100%;
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: center;
Â  Â  Â  gap: 10px;
Â  Â  Â  z-index: 1000; /* Garante que os botÃµes fiquem acima da cena AR */
Â  Â  }
Â  Â  button {
Â  Â  Â  padding: 12px 20px;
Â  Â  Â  font-size: 16px;
Â  Â  Â  background-color: #03a9f4;
Â  Â  Â  color: white;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  /* A-Frame scene will take full screen, but with a lower z-index */
Â  Â  a-scene {
Â  Â  Â  position: absolute;
Â  Â  Â  top: 0;
Â  Â  Â  left: 0;
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  Â  z-index: 1; /* Coloca a cena abaixo dos botÃµes */
Â  Â  }
Â  </style>
</head>
<body>
Â  <div id="buttons">
Â  Â  <button id="micButton">ðŸŽ¤ Falar</button>
Â  Â  <button id="arButton">Ativar AR</button>
Â  </div>

Â  <a-scene id="scene" embedded xr-mode-ui="enabled: true"
Â  Â  renderer="antialias: true" gesture-detector>

Â  Â  <a-assets>
Â  Â  Â  <a-asset-item id="model" src="kioto.glb"></a-asset-item>
Â  Â  </a-assets>

Â  Â  <a-entity
Â  Â  Â  id="glb"
Â  Â  Â  gltf-model="#model"
Â  Â  Â  animation-mixer
Â  Â  Â  rotation="0 0 0"
Â  Â  Â  position="0 0 -2"
Â  Â  Â  scale="1 1 1"
Â  Â  Â  gesture-detector
Â  Â  ></a-entity>

Â  Â  <a-plane position="0 0 -4" rotation="-90 0 0" width="10" height="10" color="#7BC8A4"></a-plane>
Â  Â  <a-sky color="#ECECEC"></a-sky>
Â  Â  <a-light type="ambient" color="#FFF"></a-light>
Â  Â  
Â  Â  <a-entity camera position="0 1.6 0" look-controls="enabled: true"></a-entity>
Â  </a-scene>

Â  <script>
Â  Â  const modelEntity = document.getElementById('glb');
    const arButton = document.getElementById('arButton');
Â  Â  const scene = document.querySelector('a-scene');

Â  Â  // Componente para detectar gestos e rotacionar o modelo
Â  Â  AFRAME.registerComponent('gesture-detector', {
Â  Â  Â  init: function () {
Â  Â  Â  Â  this.el.sceneEl.addEventListener('loaded', () => {
Â  Â  Â  Â  Â  const scene = this.el.sceneEl;
Â  Â  Â  Â  Â  scene.addEventListener('onefingermove', (event) => {
Â  Â  Â  Â  Â  Â  const rotation = this.el.getAttribute('rotation');
Â  Â  Â  Â  Â  Â  this.el.setAttribute('rotation', {
Â  Â  Â  Â  Â  Â  Â  x: rotation.x,
Â  Â  Â  Â  Â  Â  Â  y: rotation.y + event.detail.positionChange.x * 2,
Â  Â  Â  Â  Â  Â  Â  z: rotation.z
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });
Â  Â  Â  }
Â  Â  });

    // LÃ³gica para o botÃ£o AR
    arButton.addEventListener('click', () => {
      scene.enterAR();
      scene.querySelector('a-plane').setAttribute('visible', 'false');
      scene.querySelector('a-sky').setAttribute('visible', 'false');
    });

Â  Â  const comandos = {
Â  Â  Â  'olÃ¡': 'ola.mp3',
Â  Â  Â  'bom dia': 'bom_dia.mp3',
Â  Â  Â  'boa tarde': 'boa_tarde.mp3',
Â  Â  Â  'boa noite': 'boa_noite.mp3',
Â  Â  Â  'qual seu nome': 'qual_seu_nome.mp3',
Â  Â  Â  'quer ser meu amigo': 'quer_ser_meu_amigo.mp3',
Â  Â  Â  'nÃ£o entendi': 'nao_entendi.mp3',
Â  Â  };

Â  Â  const micButton = document.getElementById('micButton');
Â  Â  let recognition;
Â  Â  if ('webkitSpeechRecognition' in window) {
Â  Â  Â  recognition = new webkitSpeechRecognition();
Â  Â  Â  recognition.lang = 'pt-BR';
Â  Â  Â  recognition.continuous = false;
Â  Â  Â  recognition.interimResults = false;

Â  Â  Â  micButton.addEventListener('click', () => {
Â  Â  Â  Â  recognition.start();
Â  Â  Â  });

Â  Â  Â  recognition.onresult = (event) => {
Â  Â  Â  Â  const comando = event.results[0][0].transcript.toLowerCase();
Â  Â  Â  Â  console.log('Comando de voz:', comando);

Â  Â  Â  Â  if (comando.includes('danÃ§ar')) {
Â  Â  Â  Â  Â  modelEntity.setAttribute('animation-mixer', '');
Â  Â  Â  Â  } else if (comando.includes('parar')) {
Â  Â  Â  Â  Â  modelEntity.removeAttribute('animation-mixer');
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  const arquivo = comandos[comando];
Â  Â  Â  Â  Â  if (arquivo) {
Â  Â  Â  Â  Â  Â  const audio = new Audio(arquivo);
Â  Â  Â  Â  Â  Â  audio.play();
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  const fallback = new Audio('nao_entendi.mp3');
Â  Â  Â  Â  Â  Â  fallback.play();
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  };
Â  Â  } else {
Â  Â  Â  alert('Reconhecimento de voz nÃ£o suportado neste navegador.');
Â  Â  }
Â  </script>
</body>
</html>
